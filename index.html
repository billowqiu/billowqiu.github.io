<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="taocoding">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="taocoding">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="taocoding">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>taocoding</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d13234060d812cb98a47e937139083a9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">taocoding</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/11/jaeger-practice/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/11/jaeger-practice/" itemprop="url">jaegerå®æˆ˜</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-04-11T20:12:56+08:00">
                2019-04-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>åštracingé€‰å‹æ—¶å‘ç°é™¤äº†Zipkin(è¿™ä¸ªå…¶å®å¾ˆä¹…ä¹‹å‰å°±æœ‰æ‰€é—»ï¼Œä½†æ˜¯ä¸€ç›´æ²¡å®æ“è¿‡)ï¼Œè¿˜æœ‰Uberå¼€æºçš„<a href="https://www.jaegertracing.io" target="_blank" rel="noopener">Jaeger</a>ï¼Œçœ‹åˆ°å®˜ç½‘å°±æ„Ÿè§‰è¿™æ˜¯ä¸€ä¸ªç”¨å¿ƒçš„äº§å“ï¼Œè¿™ä¸ªåº”è¯¥ç¦»ä¸å¼€Uberæœ‰ä¸“é—¨çš„å›¢é˜Ÿç»´æŠ¤ã€‚</p>
<h4 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h4><p>å®˜ç½‘åˆ—äº†å‡ ä¸ªç‰¹æ€§ï¼š</p>
<ul>
<li>Opentracingå…¼å®¹ï¼Œæä¾›äº†Go, Java, Node, Python, C++çš„å®˜æ–¹å®¢æˆ·ç«¯</li>
<li>æœåŠ¡ä¹‹é—´ä½¿ç”¨ä¸€è‡´çš„é‡‡æ ·é€»è¾‘</li>
<li>å¤šå­˜å‚¨æ”¯æŒï¼šCassandra, Elasticsearch, Kafka, memory</li>
<li>åŠ¨æ€é‡‡æ ·(åæ§½ä¸€ä¸‹è¿™ä¸ªï¼Œä¸€å¹´å¤šäº†ï¼Œè¿˜æ²¡åˆå…¥å¼€æºç‰ˆæœ¬)</li>
<li>æ”¯æŒæ”¶é›†çš„æ•°æ®åšåç»­åˆ†æ</li>
<li>ç°ä»£åŒ–çš„UI</li>
<li>äº‘åŸç”Ÿæ”¯æŒ</li>
<li>å¯è§†åŒ–(æ¯ä¸ªç»„å»ºéƒ½æ”¯æŒå°†metricå¯¼å‡ºåˆ°Prometheus)</li>
<li>å…¼å®¹Zipkin</li>
</ul>
<p>ç”±äºè°ƒç ”çš„æ—¶å€™æ²¡æ³•å¯¹ç»†èŠ‚åšæ·±å…¥äº†è§£ï¼Œå½“æ—¶é€‰æ‹©Jaegeræœ€é‡è¦çš„ä¸€ç‚¹å…¶å®æ˜¯å…¶å®æ˜¯ï¼š<strong>jaeger-agentæ˜¯ä¸€ä¸ªé€šè¿‡UDPæ–¹å¼æ¥æ”¶æœ¬æœºå‘å‡ºçš„spansã€‚</strong><br>ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸€ç‚¹å‘¢ï¼Ÿå› ä¸ºå¯¹äºä¸šåŠ¡æ¥è¯´tracingå…¶å®æ˜¯ä¸€ä¸ªç›¸å¯¹æ— å…³ç´§è¦çš„ä¸œè¥¿ï¼Œå¦‚æœç»™ä¸€ä¸ªTCPçš„é€šé“è®©å®ƒä¸ŠæŠ¥ï¼Œå…¶å®æ˜¯ä¸å¤ªå‹å¥½çš„ï¼Œæ€§èƒ½å’Œç»´æŠ¤æ€§æ–¹é¢éƒ½æ²¡æœ‰UDPå¥½ã€‚</p>
<h4 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h4><p><img src="https://www.jaegertracing.io/img/architecture.png" alt="Jaegeræ¶æ„å›¾"></p>
<ul>
<li>jaeger-clientï¼šåµŒå…¥åœ¨åº”ç”¨ç¨‹åºé‡Œé¢ï¼Œè´Ÿè´£spançš„åˆ›å»ºä»¥åŠä¸ŠæŠ¥</li>
<li>jaeger-agentï¼šæ¯ä¸ªç‰©ç†æœºéƒ¨ç½²ä¸€ä¸ªï¼Œè´Ÿè´£æ”¶é›†clientä¸ŠæŠ¥çš„spanï¼Œç„¶åè½¬å‘ç»™collector</li>
<li>jaeger-collectorï¼šæ¥æ”¶agentå‘æ¥çš„spanï¼Œå†™å…¥åç«¯å­˜å‚¨</li>
<li>jaeger-queryï¼šæä¾›restæ¥å£ï¼Œè´Ÿè´£ä»å­˜å‚¨ä¸­æ‹‰å–traceä¿¡æ¯ä¾›UIæŸ¥è¯¢</li>
<li>jaeger-uiï¼šå±•ç¤ºtraceå’ŒæœåŠ¡ä¾èµ–å›¾</li>
</ul>
<h4 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h4><p>å¦‚æœæƒ³å¿«é€Ÿä½“éªŒï¼Œå¯ä»¥æŒ‰ç…§å®˜ç½‘çš„<a href="https://www.jaegertracing.io/docs/1.11/deployment/" target="_blank" rel="noopener">Docker</a>æ–¹å¼éƒ¨ç½²ï¼Œç”±äºå½“æ—¶çš„çº¿ä¸Šç¯å¢ƒè¿˜æ²¡æœ‰è¿™æ–¹é¢çš„æ”¯æŒï¼Œä¸‹é¢ä»¥æœ€æ–°çš„ReleaseäºŒè¿›åˆ¶ç‰ˆæœ¬ç®€è¿°ä¸€ä¸‹éƒ¨ç½²çš„æµç¨‹ã€‚</p>
<h5 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h5><ul>
<li>Jaegerå®‰è£…åŒ…:<br>  <a href="https://github.com/jaegertracing/jaeger/releases/download/v1.11.0/jaeger-1.11.0-darwin-amd64.tar.gz" target="_blank" rel="noopener">https://github.com/jaegertracing/jaeger/releases/download/v1.11.0/jaeger-1.11.0-darwin-amd64.tar.gz</a></li>
<li>elasticsearch-6.4.0:<br>  <a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.4.0.tar.gz" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.4.0.tar.gz</a></li>
</ul>
<h5 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h5><ol>
<li>bin/elasticsearch</li>
<li>SPAN_STORAGE_TYPE=elasticsearch ./jaeger-collector</li>
<li>./jaeger-agent â€“collector.host-port 127.0.0.1:14267</li>
<li>SPAN_STORAGE_TYPE=elasticsearch ./jaeger-query</li>
</ol>
<p>æ‰“å¼€<a href="http://127.0.0.1:16686å³å¯çœ‹åˆ°Jaegerçš„æŸ¥è¯¢é¡µé¢ï¼š" target="_blank" rel="noopener">http://127.0.0.1:16686å³å¯çœ‹åˆ°Jaegerçš„æŸ¥è¯¢é¡µé¢ï¼š</a><br><img src="/images/2019/04/jaeger-ui.png" alt="" title="jaeger-ui"></p>
<ul>
<li>Searchï¼ŒæŒ‰ç…§ æœåŠ¡:æ“ä½œï¼Œtagï¼Œæ—¶é—´ç­‰ç»´åº¦è¿›è¡Œtraceçš„ç­›é€‰</li>
<li>Compareï¼Œæ¯”è¾ƒä¸¤ä¸ªtrace</li>
<li>Dependenciesï¼ŒæŸ¥çœ‹æœåŠ¡ä¾èµ–å›¾ï¼Œè¿™ä¸ªéœ€è¦ä¸€ä¸ªå•ç‹¬çš„Sparkä»»åŠ¡æ‰èƒ½ç”Ÿæˆï¼Œä¸‹æ–‡ä¼šè®²åˆ°</li>
</ul>
<h5 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h5><p>Jaegerçš„å®‰è£…åŒ…é‡Œé¢è‡ªå¸¦äº†ä¸€ä¸ªæµ‹è¯•ç¨‹åº:example-hotrodï¼Œæ¨¡æ‹ŸUberçš„æ‰“è½¦æœåŠ¡ï¼Œé€šè¿‡å¦‚ä¸‹æ–¹å¼å¯åŠ¨ï¼š</p>
<pre><code>jaeger-1.11.0-darwin-amd64 billowqiu$ ./example-hotrod all
</code></pre><p>è¿™æ ·ä¼šä¸€æ¬¡æ€§å¯åŠ¨æ‰€æœ‰çš„æœåŠ¡ï¼ŒåŒ…æ‹¬ï¼šCustomer serviceï¼ŒDriver serviceï¼ŒRoute serviceï¼ŒFrontend serviceï¼ŒåŒæ—¶å†…éƒ¨è¿˜ä¼šæ¨¡æ‹Ÿè°ƒç”¨MySQLå’ŒRedisã€‚<br>å¯åŠ¨è¯¥æœåŠ¡åï¼Œæ‰“å¼€<a href="http://127.0.0.1:8080/" target="_blank" rel="noopener">http://127.0.0.1:8080/</a> éšä¾¿ç‚¹ä¸€ä¸ªä¹˜å®¢å§“åï¼Œè¿™æ—¶åœ¨Jaegerçš„uié‡Œé¢å¯ä»¥çœ‹åˆ°å¦‚ä¸‹traceï¼š<br><img src="/images/2019/04/hotrod_trace.png" alt="" title="hotrod_trace"></p>
<p>ç‚¹è¿›å»å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„traceï¼š<br><img src="/images/2019/04/hotrod_trace_detail.png" alt="" title="hotrod_trace_detail"></p>
<h5 id="Dependenciesç”Ÿæˆ"><a href="#Dependenciesç”Ÿæˆ" class="headerlink" title="Dependenciesç”Ÿæˆ"></a>Dependenciesç”Ÿæˆ</h5><p>ä¸Šé¢é€šè¿‡ä¾‹å­ç¨‹åºå¯ä»¥çœ‹åˆ°6ä¸ªæœåŠ¡çš„è°ƒç”¨æµç¨‹åŠè€—æ—¶ç­‰traceæ•°æ®ï¼Œä½†æ˜¯<a href="http://127.0.0.1:16686/dependencies" target="_blank" rel="noopener">http://127.0.0.1:16686/dependencies</a> é‡Œé¢ä¾ç„¶æ˜¯ç©ºçš„ï¼Œè¿™æ˜¯å› ä¸ºæœåŠ¡ä¾èµ–å›¾éœ€è¦å•ç‹¬çš„ä»»åŠ¡ç”Ÿæˆï¼š<br>    <a href="https://github.com/jaegertracing/spark-dependencies" target="_blank" rel="noopener">jaegertracing/spark-dependencies</a>ï¼Œ å½“æ—¶ä¸ºäº†è§£å†³ä¸€ä¸ªç”Ÿäº§ç¯å¢ƒçš„é—®é¢˜ï¼Œè¿˜ä¸ºè¿™ä¸ªé¡¹ç›®æäº†ä¸ª<a href="https://github.com/jaegertracing/spark-dependencies/pull/39" target="_blank" rel="noopener">pr</a>ï¼Œæœ€åå®˜æ–¹åˆå…¥äº†masterï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªå°æƒŠå–œå§ã€‚<br>ä»£ç cloneä¸‹æ¥ä¹‹åæ‰§è¡Œï¼š</p>
<pre><code>spark-dependencies billowqiu$ mvn clean package -Dmaven.test.skip=true
</code></pre><p>è¿™æ ·ä¼šbuildä¸€ä¸ªjaråŒ…ï¼Œç„¶åæ‰§è¡Œï¼š</p>
<pre><code>spark-dependencies billowqiu$ STORAGE=elasticsearch ES_NODES=http://localhost:9200 java -jar jaeger-spark-dependencies/target/jaeger-spark-dependencies-0.0.1-SNAPSHOT.jar
</code></pre><p>åœ¨Macä¸‹é¢å¯èƒ½ä¼šå‡ºç°ï¼šCanâ€™t assign requested address: Service â€˜sparkDriverâ€™ failed after 16 retries (starting from 0) è¿™ä¸ªé”™è¯¯ï¼Œå¯ä»¥å‚ç…§<a href="https://stackoverflow.com/questions/34601554/mac-spark-shell-error-initializing-sparkcontext" target="_blank" rel="noopener">è¿™ä¸ª</a>è§£å†³ã€‚<br>è¿™æ—¶å†æ‰“å¼€<a href="http://127.0.0.1:16686/dependencies" target="_blank" rel="noopener">http://127.0.0.1:16686/dependencies</a> é€‰æ‹©DAGï¼ŒæœåŠ¡ä¾èµ–å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/images/2019/04/hotrod_trace_dependencies.png" alt="" title="hotrod_trace_dependencies"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/11/opentracing-api-overview/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/11/opentracing-api-overview/" itemprop="url">opentracing-api-overview</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-11-11T21:27:00+08:00">
                2018-11-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>opentracingæ˜¯ä¸€ä¸ªAPIè§„èŒƒï¼Œå„ç±»æ¡†æ¶å’Œåº“è´Ÿè´£å®ç°è¯¥è§„èŒƒï¼Œä»è€Œå…è®¸å¼€å‘äººå‘˜é€šè¿‡æ‰‹åŠ¨åŸ‹ç‚¹å®ç°å¹³å°æ— å…³çš„tracingè·Ÿè¸ªã€‚ç›®å‰ä¸»æµçš„è¯­è¨€éƒ½æœ‰å¯¹åº”çš„æ¥å£æä¾›ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://opentracing.io/docs/supported-languages" target="_blank" rel="noopener">é“¾æ¥</a>ã€‚ä¸‹é¢ä»¥opentracing-goä¸ºä¾‹å¯¹å…¶åšä¸€ä¸ªå¤§è‡´ä»‹ç»ã€‚</p>
<h3 id="Span"><a href="#Span" class="headerlink" title="Span"></a>Span</h3><h4 id="SpanContext"><a href="#SpanContext" class="headerlink" title="SpanContext"></a>SpanContext</h4><p>è¡¨ç¤ºä¸€ä¸ªSpançš„çŠ¶æ€ï¼Œé€šå¸¸ä¼šä¼ é€’ç»™ç›¸å…³è”çš„Spanï¼Œä¹ŸåŒ…æ‹¬è·¨è¿›ç¨‹ä¼ é€’ï¼Œä¾‹å¦‚&lt;trace_id, span_id, sampled&gt;ã€‚ä¸»è¦æ¥å£æœ‰ï¼š<br>ForeachBaggageItem(handler func(k, v string) bool)ï¼Œhandlerå‡½æ•°ä¼šé’ˆå¯¹æ¯ä¸ªBaggageItemè¿›è¡Œè°ƒç”¨ã€‚</p>
<h4 id="Baggage"><a href="#Baggage" class="headerlink" title="Baggage"></a>Baggage</h4><p>è·Ÿspancontextä¸€æ ·ä¹Ÿæ˜¯è·¨è¿›ç¨‹ä¼ é€’çš„ï¼Œä¸ºä¸€ç³»åˆ—keyï¼švalueå¯¹</p>
<h4 id="Tag"><a href="#Tag" class="headerlink" title="Tag"></a>Tag</h4><p>è®¾ç½®ç”¨äºè¿‡æ»¤spançš„tagsï¼Œå…¶ä¸­keyå¿…é¡»æ˜¯stringç±»å‹ï¼Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œopentracingæœ‰ä¸€äº›é¢„å®šä¹‰çš„<a href="https://github.com/opentracing/specification/blob/master/semantic_conventions.md" target="_blank" rel="noopener">tags</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SetTag(key string, value interface&#123;&#125;) Span</span><br><span class="line">span.SetTag()</span><br></pre></td></tr></table></figure></p>
<h4 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LogFields(fields ...log.Field)</span><br><span class="line">//    span.LogFields(</span><br><span class="line">//        log.String(&quot;event&quot;, &quot;soft error&quot;),</span><br><span class="line">//        log.String(&quot;type&quot;, &quot;cache timeout&quot;),</span><br><span class="line">//        log.Int(&quot;waited.millis&quot;, 1500))</span><br></pre></td></tr></table></figure>
<h4 id="Finish"><a href="#Finish" class="headerlink" title="Finish"></a>Finish</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FinishWithOptions(opts FinishOptions)</span><br><span class="line">é€šå¸¸è¿™æ˜¯å¯¹äºspançš„æœ€åä¸€ä¸ªæ“ä½œï¼Œç›®å‰çœ‹åˆ°çš„å®ç°åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨è¿™ä¸ªåŠ¨ä½œåšspançš„ä¸ŠæŠ¥ã€‚</span><br><span class="line"></span><br><span class="line">type FinishOptions struct &#123;</span><br><span class="line">    FinishTime time.Time    // é‡å†™spançš„ç»“æŸæ—¶é—´</span><br><span class="line">    LogRecords []LogRecord  // å¯ä»¥åœ¨è¿™ä¸ªæ—¶å€™ä¸€æ¬¡æ€§å†™å…¥æ‰€æœ‰çš„Log,æ•ˆæœåŒæ‰‹åŠ¨è°ƒç”¨LogFields</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªspançš„åˆ—å­:</p>
<pre><code>t=0            operation name: db_query               t=x 

 +-----------------------------------------------------+
 | Â· Â· Â· Â· Â· Â· Â· Â· Â· Â·    Span     Â· Â· Â· Â· Â· Â· Â· Â· Â· Â· |
 +-----------------------------------------------------+
</code></pre><p>Tags:</p>
<ul>
<li>db.instance:â€jdbc:mysql://127.0.0.1:3306/customers</li>
<li>db.statement: â€œSELECT * FROM mytable WHERE foo=â€™barâ€™;â€</li>
</ul>
<p>Logs:</p>
<ul>
<li>message:â€Canâ€™t connect to mysql server on â€˜127.0.0.1â€™(10061)â€</li>
</ul>
<p>SpanContext:</p>
<ul>
<li>trace_id:â€abc123â€</li>
<li>span_id:â€xyz789â€</li>
<li>Baggage Items:<ul>
<li>special_id:â€vsid1738â€</li>
</ul>
</li>
</ul>
<hr>
<h3 id="Tracer"><a href="#Tracer" class="headerlink" title="Tracer"></a>Tracer</h3><p>è´Ÿè´£åˆ›å»ºSpanå’ŒSpanContextçš„ä¼ æ’­ï¼Œå±äºä¸€ä¸ªManagerè§’è‰²ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">type SpanReference struct &#123;</span><br><span class="line">    // ä¸ReferencedContextçš„å…³è”å…³ç³»ï¼Œæœ‰ChildOfRefå’ŒFollowsFromRefï¼Œå…·ä½“å¯è§http://opentracing.io/spec/</span><br><span class="line">	Type              SpanReferenceType </span><br><span class="line">	// éœ€è¦å»ºç«‹å…³è”å…³ç³»çš„spancontext</span><br><span class="line">	ReferencedContext SpanContext</span><br><span class="line">&#125;</span><br><span class="line">type StartSpanOptions struct &#123;</span><br><span class="line">	// ä¸€æ¬¡å¯ä»¥è®¾ç½®0åˆ°å¤šä¸ªspanä¹‹é—´çš„å…³è”ï¼Œå¦‚æœä¸è®¾ç½®æ­¤å­—æ®µï¼Œè¡¨æ˜å½“å‰åˆ›å»ºçš„spanä¸ºroot span</span><br><span class="line">	References []SpanReference  </span><br><span class="line"></span><br><span class="line">	// StartTime overrides the Span&apos;s start time, or implicitly becomes</span><br><span class="line">	// time.Now() if StartTime.IsZero().</span><br><span class="line">	// æŒ‡å®šspançš„å¼€å§‹æ—¶é—´</span><br><span class="line">	StartTime time.Time</span><br><span class="line"></span><br><span class="line">    // ç±»ä¼¼äºSpançš„SetTag()</span><br><span class="line">	Tags map[string]interface&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„span</span><br><span class="line">StartSpan(operationName string, opts ...StartSpanOption) Span</span><br><span class="line"></span><br><span class="line">// å°†smæŒ‰ç…§formatçš„æ ¼å¼åºåˆ—åŒ–åˆ°carrierï¼Œé€šå¸¸æ˜¯åœ¨clientç«¯è°ƒç”¨</span><br><span class="line">Inject(sm SpanContext, format interface&#123;&#125;, carrier interface&#123;&#125;) error</span><br><span class="line">// ä»carrierä¸­æŒ‰ç…§formatçš„æ ¼å¼å–å‡ºsmï¼Œé€šå¸¸æ˜¯åœ¨serverç«¯æ”¶åˆ°clientè°ƒç”¨åï¼Œå–å‡ºspancontext</span><br><span class="line">Extract(format interface&#123;&#125;, carrier interface&#123;&#125;) (SpanContext, error)</span><br><span class="line"></span><br><span class="line">// opentracingæœ‰å®šä¹‰ä¸€äº›å†…ç½®çš„BuiltinFormatï¼š</span><br><span class="line">Binaryï¼šäºŒè¿›åˆ¶æ–¹å¼</span><br><span class="line">TextMapï¼škey:value çš„string pairsï¼Œå¯¹åº”çš„carrierç±»å‹ä¸ºmap[string]string</span><br><span class="line">HTTPHeadersï¼šä½œä¸ºHTTP headerçš„string pairsï¼Œå¯¹åº”çš„carrierç±»å‹ä¸ºhttp.Header</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/21/distrituted-tracing-history/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/21/distrituted-tracing-history/" itemprop="url">åˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿå†å²</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-10-21T23:23:27+08:00">
                2018-10-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><p>ä»äº”æœˆä»½åˆ°ç°åœ¨ä¸€ç›´éƒ½åœ¨å’Œtracingæ‰“äº¤é“ï¼Œä¹Ÿç®—å¯¹è¿™ä¸ªé¢†åŸŸæœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œæ‰“ç®—åšç‚¹è®°å½•ï¼Œç¬¬ä¸€ç¯‡å°±ä»tracingç³»ç»Ÿçš„å†å²è¯´èµ·ã€‚</p>
<h4 id="tracingç³»ç»Ÿå†å²"><a href="#tracingç³»ç»Ÿå†å²" class="headerlink" title="tracingç³»ç»Ÿå†å²"></a>tracingç³»ç»Ÿå†å²</h4><p>Googleåœ¨äº’è”ç½‘é¢†åŸŸåŸºç¡€è®¾æ–½æ–¹é¢çš„ç†è®ºè´¡çŒ®çœŸçš„æ˜¯å½“ä¹‹æ— æ„§çš„No.1ï¼Œä»æ—©æœŸçš„ä¸‰é©¾é©¬è½¦ï¼Œåˆ°tracingç›¸å…³å¼€æºç³»ç»Ÿçš„é¼»ç¥–<a href="https://ai.google/research/pubs/pub36356" target="_blank" rel="noopener">Dapper</a>ï¼Œå†åˆ°è¿‘å¹´çš„spannerï¼ŒF1ç­‰ç­‰ï¼Œå‡ ä¹éƒ½æ˜¯å‘ä¸ªpaperç§‘æ™®ä¸€ä¸‹è‡ªå®¶å·²ç»è¿è¥Nå¹´çš„ä¸œè¥¿ï¼Œç„¶åå¼€æºé¢†åŸŸå°±å„ç§å¼€ç§â€å±±å¯¨â€ã€‚<br>è°ƒç”¨é“¾è·Ÿè¸ªè¿™ä¸ªè¯é¢˜ï¼Œå…¶å®å¾ˆæ—©å°±æœ‰äº†ï¼Œå…·ä½“å¯ä»¥å»ç¿»çœ‹ä¸€ä¸‹dapperçš„å¼•ç”¨æ–‡çŒ®ï¼Œä½†æ˜¯æœ€è¿‘ä¸¤å¹´å› ä¸ºå¾®æœåŠ¡çš„ç«çƒ­ï¼Œå„å¤§å…¬å¸æ‰å¼€å§‹çœŸæ­£å¯¹è¿™ä¸ªä¸œè¥¿é‡è§†ï¼Œæ¯•ç«Ÿä¸€ä¸ªæ¥å£çš„è°ƒç”¨å¯èƒ½å¼•èµ·å‡ åä¸ªç”šè‡³ä¸Šç™¾ä¸ªä¸‹æ¸¸æœåŠ¡çš„è°ƒç”¨ï¼Œå¦‚æœæ²¡æœ‰ä¸€ä¸ªè·Ÿè¸ªç³»ç»Ÿï¼Œå¯¹äºé—®é¢˜çš„å®šä½éš¾åº¦å¯æƒ³è€ŒçŸ¥ã€‚</p>
<ul>
<li>Dapperè®ºæ–‡å‘è¡¨äº2010å¹´ï¼Œ<a href="http://bigbully.github.io/Dapper-translation/" target="_blank" rel="noopener">ç¿»è¯‘ç‰ˆ</a></li>
<li>Twitteråœ¨2012å¹´å¼€æºäº†<a href="https://blog.twitter.com/engineering/en_us/a/2012/distributed-systems-tracing-with-zipkin.html" target="_blank" rel="noopener">zipkin</a></li>
<li>zipkinå¼€æºå<ul>
<li>ä¼°è®¡Twitterç»´æŠ¤ä¸åŠ›ï¼Œè€Œä¸”æ˜¯ç›¸å¯¹å°ä¼—çš„scaleå†™çš„ï¼Œåé¢ç”±å¼€æºç¤¾åŒºç”¨javaé‡å†™äº†å¹¶æ”¹åä¸º<a href="https://zipkin.io" target="_blank" rel="noopener">OpenZipkin</a>ç»§ç»­ç»´æŠ¤ç»´æŠ¤</li>
<li>7æœˆä»½å®Œæˆäº†2.0çš„æ•°æ®æ¨¡å‹åˆ‡æ¢<a href="https://github.com/openzipkin/zipkin/releases/tag/2.10.1" target="_blank" rel="noopener">Zipkin 2.10 completes our v2 migration</a></li>
<li>8.30å·æç»™äº†<a href="http://incubator.apache.org/projects/zipkin.html" target="_blank" rel="noopener">Apache</a>ã€‚</li>
</ul>
</li>
<li>Jaegerçš„è¯ç”Ÿ<ul>
<li>Uberåœ¨é›†æˆåˆ°å†…éƒ¨ç³»ç»Ÿä¹‹åå„ç§å‘å‡ºæ¥äº†ï¼Œå…·ä½“å¯è§<a href="https://eng.uber.com/distributed-tracing/" target="_blank" rel="noopener">Evolving Distributed Tracing at Uber Engineering</a>ï¼Œäºæ˜¯å¦èµ·ç‚‰ç¶äº2017å¹´åˆå¼€æºäº†<a href="https://www.jaegertracing.io" target="_blank" rel="noopener">Jaeger</a></li>
</ul>
</li>
</ul>
<h4 id="tracingæ ‡å‡†"><a href="#tracingæ ‡å‡†" class="headerlink" title="tracingæ ‡å‡†"></a>tracingæ ‡å‡†</h4><ul>
<li><p><a href="https://opentracing.io/" target="_blank" rel="noopener">opentracing</a></p>
<p>  2016å¹´å°±å¼€å§‹å¯åŠ¨äº†ï¼Œä¸ºäº†è§£å†³tracingç³»ç»Ÿå„è‡ªä¸ºæ”¿ï¼Œæäº†ä¸ªç»Ÿä¸€çš„æ ‡å‡†ï¼Œå¹¶æä¾›äº†å„ç§è¯­è¨€çš„apiã€‚ç›®å‰çš„ä¸»è¦å‚ä¸è€…ä¸ºUberï¼ŒLightStep(Dapperç¬¬ä¸€ä½œè€…çš„å…¬å¸)ï¼ŒRedhat(Jaegerå¼€æºåï¼Œç›´æ¥æ”¾å¼ƒè‡ªå®¶ç ”å‘çš„ç±»ä¼¼äº§å“ï¼Œè½¬è€Œåˆ°Jaegerä¸Šé¢æ¥äº†ï¼Œå“ˆ)ç­‰å…¬å¸ã€‚</p>
</li>
<li><p><a href="https://opencensus.io/" target="_blank" rel="noopener">opencensus</a></p>
<p>  Googleå¹´åˆæå‡ºçš„ä¸€ä¸ªé›†metricså’Œtracingçš„æ–°æ ‡å‡†ï¼Œä¼°è®¡ä¸€æ–¹é¢æ˜¯çœ‹åˆ°Opentracingæƒ³ç«äº‰ä¸€æŠŠï¼Œå°±åƒä¹‹å‰çš„å®¹å™¨ç¼–æ’ä¸€æ ·ï¼Œå¦å¤–ä¹Ÿå¯ä»¥æ¨å¹¿è‡ªå·±å®¶çš„<a href="https://cloud.google.com/stackdriver/" target="_blank" rel="noopener">Stackdriver</a>ï¼Œç›®å‰<a href="https://open.microsoft.com/2018/06/13/microsoft-joins-the-opencensus-project/" target="_blank" rel="noopener">å¾®è½¯</a>ä¹ŸåŠ å…¥äº†å¯¹è¯¥æ ‡å‡†çš„æ”¯æŒï¼Œå‡†å¤‡æåˆ°è‡ªå·±çš„Auzeé‡Œé¢ã€‚</p>
</li>
<li><p><a href="https://github.com/w3c/distributed-tracing" target="_blank" rel="noopener">w3c/distributed-tracing</a></p>
<p>  2017å¹´æå‡ºçš„ä¸€ä¸ªä¸ºäº†ç»Ÿä¸€å„ç§tracerç³»ç»Ÿä¸­Contextæ ¼å¼æ ‡å‡†ï¼Œç›®å‰è¿˜æ˜¯Drafté˜¶æ®µï¼Œä¸»è¦å‚ä¸è€…ä¸ºGoogleå’Œå¾®è½¯ã€‚</p>
</li>
</ul>
<h4 id="tracerå®ç°"><a href="#tracerå®ç°" class="headerlink" title="tracerå®ç°"></a>tracerå®ç°</h4><p>ä¸Šé¢æåˆ°äº†ä¸‰ä¸ªtracingæ ‡å‡†ï¼Œw3cçš„å°±ä¸è¯´äº†ï¼Œopencensusç”±äºæ˜¯è°·æ­Œä¸»å¯¼çš„ï¼Œå‚ä¸è€…ä¸å¤šï¼Œç›¸åº”çš„tracerå®ç°ä¹Ÿåªæœ‰è‡ªå®¶çš„Stackdriverã€‚<br>opentracingå®ç°åˆ™æ˜¯<a href="https://opentracing.io/docs/supported-tracers/" target="_blank" rel="noopener">éåœ°å¼€èŠ±</a>ï¼š</p>
<ul>
<li>Jaeger</li>
<li>Appdash</li>
<li>LightStep</li>
<li>Instana</li>
<li>SkyWalking</li>
<li>inspectIT</li>
<li>stagemonitor</li>
<li>Datadog</li>
</ul>
<p>å…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯å•†ä¸šäº§å“ï¼Œé¡ºå¸¦æ”¯æŒä¸€ä¸‹opentracingï¼Œè€Œä¸”éƒ½æ˜¯å±äºAPMçº§åˆ«çš„ï¼ŒZipkinç«Ÿç„¶ä¸åœ¨ååˆ—ï¼ï¼ï¼<br>å¼€æºæ–¹é¢çš„ï¼ŒJaegerå’ŒAppdashéƒ½æ˜¯goè¯­è¨€å¼€å‘çš„ï¼Œéƒ¨ç½²èµ·æ¥ç›¸å¯¹æ¯”è¾ƒè½»ä¾¿ï¼›è€Œä¸”JaegerèƒŒåæœ‰Uberæ”¯æŒï¼Œæä¾›äº†ä¸ªå„ç§è¯­è¨€çš„APIï¼Œè¿™ä¸ªä¹Ÿæ˜¯å½“æ—¶æŠ€æœ¯é€‰å‹æ—¶é€‰æ‹©çš„ä¸€ä¸ªç‚¹ï¼ŒåŒæ—¶å…¶åŸºäºUDPæ–¹å¼çš„Agentæ•°æ®é‡‡é›†ä¹Ÿæ¯”è¾ƒç¬¦åˆä¸ªäººçš„èƒƒå£ã€‚</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>éšç€å¾®æœåŠ¡çš„æµè¡Œï¼Œä¼ ç»Ÿçš„å•ä½“åº”ç”¨ç›‘æ§å·²ç»ä¸èƒ½æ»¡è¶³å¤§è§„æ¨¡åˆ†å¸ƒå¼æœåŠ¡ä¹‹é—´çš„é—®é¢˜å®šä½ï¼Œåˆ†å¸ƒå¼è·Ÿè¸ªåˆšå¥½èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè€ŒOpentracingçš„å‡ºç°ç»Ÿä¸€äº†å„ä¸ªTracerç³»ç»Ÿçš„æ¥å…¥æ ‡å‡†ï¼Œè®©å¼€å‘è€…åœ¨é€‰æ‹©çš„æ—¶å€™ä¸ç”¨ç»‘å®šåœ¨æŸä¸€ä¸ªå‚å•†ã€‚ç”±äºtracingå’Œmonitoringåœ¨å®ç°å’Œç”¨é€”ä¸Šæœ‰ä¸€å®šçš„é‡å ï¼Œé›†tracingå’Œmonitoringçš„APMåº”è¯¥æ˜¯è¯¥é¢†åŸŸçš„ä¸€ä¸ªè¶‹åŠ¿ï¼Œè¿™ä¹Ÿæ˜¯opencensusçš„ä¸€å¤§ä¼˜åŠ¿ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/25/sakura/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/25/sakura/" itemprop="url">sakura</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-03-25T20:37:30+08:00">
                2018-03-25
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/ç”Ÿæ´»è½¨è¿¹/" itemprop="url" rel="index">
                    <span itemprop="name">ç”Ÿæ´»è½¨è¿¹</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>10å¹´å‰å»è¿‡ä¸€æ¬¡æ­¦æ±‰å¤§å­¦ï¼Œé‚£ä¼šä¹Ÿæ²¡æœ‰ç‰¹åˆ«çš„è§‰å¾—æ¨±èŠ±æœ‰å¤šç¾ï¼Œç›´åˆ°å‰ä¸¤å¹´å»äº†ä¸€è¶Ÿå²›å›½ï¼Œä¹Ÿæ˜¯ä¸‰æœˆä¸­ä¸‹æ—¬ï¼Œå†ä¸€æ¬¡è§åˆ°æ¨±èŠ±ï¼Œæ‰å‘ç°å¥¹çš„ç¾ï¼Œå¯æƒœçš„æ˜¯å²›å›½æ¨±èŠ±ç››å¼€æœŸæ¯”æ­¦æ±‰è¿™è¾¹çš„æ™šï¼Œæ‰€ä»¥é‚£æ¬¡ä¹Ÿæ²¡æœ‰çœ‹åˆ°ç››å¼€çš„åœºæ™¯ï¼Œä»Šå¤©ç»ˆäºåœ¨æ¨±èŠ±çš„ç››å¼€æœŸè¿‘è·ç¦»æ‹äº†å‡ å¼ ï¼Œç¡®å®ç¾ï¼Œä¸æ„§ä¸ºå²›å›½å›½èŠ±ã€‚</p>
<p><img src="/images/2018/03/IMG_0130.JPG" alt="æ¨±èŠ±" title="sakura"><br><img src="/images/2018/03/IMG_7937.JPG" alt="æ¨±èŠ±" title="sakura"><br><img src="/images/2018/03/IMG_2237.JPG" alt="æ¨±èŠ±" title="sakura"><br><img src="/images/2018/03/IMG_3590.JPG" alt="æ¨±èŠ±" title="sakura"><br><img src="/images/2018/03/IMG_6728.JPG" alt="æ¨±èŠ±" title="sakura"><br><img src="/images/2018/03/IMG_9035.JPG" alt="æ¨±èŠ±" title="sakura"><br><img src="/images/2018/03/IMG_0267.JPG" alt="æ¨±èŠ±" title="sakura"><br><img src="/images/2018/03/IMG_1079.JPG" alt="æ¨±èŠ±" title="sakura"><br><img src="/images/2018/03/IMG_2215.JPG" alt="æ¨±èŠ±" title="sakura"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/19/boost-python/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/19/boost-python/" itemprop="url">boost.python</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-11-19T17:55:37+08:00">
                2017-11-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æœ€è¿‘å·¥ä½œä¸­ä½¿ç”¨åˆ°boost.pythonï¼Œæ„Ÿè§‰ç½‘ä¸Šè¿™æ–¹é¢çš„èµ„æ–™è¿˜æ˜¯æ¯”è¾ƒå°‘ï¼Œå®˜æ–¹æ–‡æ¡£å†™çš„ä¹Ÿä¸å¤Ÿè¯¦å°½ï¼Œç®—æ˜¯åšä¸ªå¤‡å¿˜å§</p>
<pre><code>const char* greet()
{
    return &quot;hello,world&quot;;
}
// operator= for index

typedef std::vector&lt;int&gt; VI;
struct Foo
{
    int32_t a;
    std::string b;
    VI vi;
    bool operator==(Foo const&amp; f) const { return f.a == a; }
};

// A friendly class.
typedef std::vector&lt;Foo&gt; VecFoo;
class hello
{
public:
    hello(const std::string&amp; country) { this-&gt;country = country; }
    std::string greet() const { return &quot;Hello from &quot; + country; }
    Foo get_foo()const
    {
        Foo foo;
        foo.a = 123;
        foo.b = country;
        return foo;
    }
public:
    std::string country;
    VecFoo vf;
};

template &lt;typename T&gt;
struct VecConvert
{
    typedef std::vector&lt;T&gt; VecT;
    static PyObject* convert(const VecT&amp; vt)
    {
        boost::python::list pylist;
        for (auto&amp; t : vt)
        {
            pylist.append(t);
        }
        return boost::python::incref(pylist.ptr());
    }
};    
</code></pre><ul>
<li>å¯¼å‡ºå‡½æ•°åŠPODç»“æ„<pre><code>boost::python::def(&quot;greet&quot;, greet);
boost::python::class_&lt;Foo&gt;(&quot;Foo&quot;)
    .def_readwrite(&quot;a&quot;, &amp;Foo::a)
    .def_readwrite(&quot;b&quot;, &amp;Foo::b)
    .def_readwrite(&quot;vi&quot;, &amp;Foo::vi);
</code></pre></li>
<li>å¯¼å‡ºç±»<pre><code>boost::python::class_&lt;hello&gt;(&quot;hello&quot;, init&lt;std::string&gt;())
    // Add a regular member function.
    .def(&quot;greet&quot;, &amp;hello::greet)
    // Add invite() as a member of hello!
    .def(&quot;invite&quot;, invite)
    .def(&quot;get_foo&quot;, &amp;hello::get_foo)
    .def_readwrite(&quot;vf&quot;, &amp;hello::vf);  
</code></pre></li>
<li>å¯¼å‡ºå®¹å™¨<ol>
<li>å¯¼å‡ºä¸€ä¸ªæ–°çš„å®¹å™¨ç±»<pre><code>boost::python::class_&lt;VI&gt;(&quot;VI&quot;).def(boost::python::vector_indexing_suite&lt;VI&gt;());
</code></pre></li>
<li>ç›´æ¥è½¬æ¢ä¸ºpythonçš„list<pre><code>boost::python::to_python_converter&lt;VI, VecConvert&lt;int&gt;&gt;();
</code></pre></li>
</ol>
</li>
<li>python listå¯¹è±¡è½¬æ¢ä¸ºc++ vector<pre><code>//c++
void setFoos(const boost::python::list&amp; pylist)
{
    std::vector&lt;Foo&gt; fs;
    for (int i =0; i&lt; boost::python::len(pylist); i++)
    {
        fs.push_back(boost::python::extract&lt;Foo&gt;(pylist[i]));
    }
}
boost::python::def(&quot;setFoos&quot;, setFoos);
//python
Foo f1,f2
setFoos([f1, f2])
</code></pre></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/11/software-engineering-advice-from-google/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/11/software-engineering-advice-from-google/" itemprop="url">software-engineering-advice-from-google</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-11-11T16:25:32+08:00">
                2017-11-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>googleè®¡ç®—ç¯å¢ƒ<ul>
<li>å¤§é‡å»‰ä»·PCç»„æˆçš„é›†ç¾¤</li>
<li>æ–°é›†ç¾¤å­˜åœ¨å¤§é‡çš„ç¡¬ä»¶æ•…éšœ</li>
</ul>
</li>
<li>googleå·¥ç¨‹ç¯å¢ƒ<ul>
<li>åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆæ•°æ®æˆ–è€…è¯·æ±‚éƒ½æ²¡æ³•åœ¨ä¸€ä¸ªæœºå™¨ä¸Šå®Œæˆï¼‰</li>
<li>éå¸ƒå…¨çƒçš„å¤šä¸ªæ•°æ®ä¸­å¿ƒ</li>
</ul>
</li>
<li>äº§å“å¤§éƒ½æ˜¯æœåŠ¡ï¼Œè€Œä¸æ˜¯ç®€å•åŒ…è£…çš„è½¯ä»¶<ul>
<li>æœåŠ¡åœ¨å†…éƒ¨ä¹Ÿä¼šå¤§é‡</li>
<li>ã€‚ã€‚ã€‚</li>
</ul>
</li>
<li>è®¾è®¡è½¯ä»¶ç³»ç»Ÿéœ€è¦å„ç§å¹³è¡¡<ul>
<li>ç®€å•</li>
<li>æ‰©å±•</li>
<li>æ€§èƒ½</li>
<li>å¯é æ€§</li>
<li>é€šç”¨æ€§</li>
<li>ä¸“æœ‰æ€§</li>
</ul>
</li>
<li>åœ¨ç¼–ç å’Œè¯¦ç»†æ–‡æ¡£ä¹‹å‰éœ€è¦åšçš„äº‹æƒ…<ul>
<li>å…ˆåšä¸€ä¸ªå¤§è‡´çš„è®¾è®¡</li>
<li>è·Ÿåšè¿‡ç±»ä¼¼ç³»ç»Ÿçš„äººåœ¨ç™½æ¿ä¸Šè®¨è®º</li>
<li>æœ€å¥½æ˜¯è®¨è®ºä¸€äº›ä¸åŒçš„å¯é€‰è®¾è®¡</li>
</ul>
</li>
<li>æ¥å£<ul>
<li>æ¥å£éœ€è¦ä»”ç»†è€ƒè™‘</li>
<li>æƒ³è±¡ä¸€ä¸‹ä¸€äº›é—ç•™çš„å®¢æˆ·éœ€è¦å¦‚ä½•ä½¿ç”¨</li>
<li>ç²¾ç¡®çš„æ–‡æ¡£ï¼Œä½†æ˜¯è¦é¿å…å®ç°ä¸Šçš„é™åˆ¶</li>
<li>åœ¨å®ç°æ¥å£ä¹‹å‰è¦æ³¨æ„åé¦ˆçš„æ„è§</li>
<li>æœ€å¥½çš„å­¦ä¹ æ–¹å¼æ˜¯å€Ÿé‰´å·²æœ‰çš„ä¼˜ç§€æ¥å£è®¾è®¡</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/05/2017-the-fisrt-tossing/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/05/2017-the-fisrt-tossing/" itemprop="url">åšå®¢æŠ˜è…¾è®°</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-02-05T14:02:27+08:00">
                2017-02-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/æœªåˆ†ç±»/" itemprop="url" rel="index">
                    <span itemprop="name">æœªåˆ†ç±»</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<ul>
<li>ç¬¬ä¸€é˜¶æ®µï¼Œåˆšæ¥è§¦Blogï¼Œè§‰å¾—å¾ˆæ–°é²œï¼Œè¯•ç€é€‰æ‹©ä¸€ä¸ªå…è´¹ç©ºé—´æ¥å†™ã€‚</li>
<li>ç¬¬äºŒé˜¶æ®µï¼Œå‘ç°å…è´¹ç©ºé—´é™åˆ¶å¤ªå¤šï¼Œå°±è‡ªå·±è´­ä¹°åŸŸåå’Œç©ºé—´ï¼Œæ­å»ºç‹¬ç«‹åšå®¢ã€‚</li>
<li>ç¬¬ä¸‰é˜¶æ®µï¼Œè§‰å¾—ç‹¬ç«‹åšå®¢çš„ç®¡ç†å¤ªéº»çƒ¦ï¼Œæœ€å¥½åœ¨ä¿ç•™æ§åˆ¶æƒçš„å‰æä¸‹ï¼Œè®©åˆ«äººæ¥ç®¡ï¼Œè‡ªå·±åªè´Ÿè´£å†™æ–‡ç« ã€‚</li>
</ul>
<hr>
<p>ä¸Šé¢è¿™æ®µæ¢æ‘˜æŠ„è‡ªé˜®ä¸€å³°çš„åšå®¢ï¼Œæœ‰ä¸€ç§ä¼¼æ›¾ç›¸è¯†çš„æ„Ÿè§‰ï¼š</p>
<ul>
<li>ç¼–ç¨‹çˆ±å¥½è€…åšå®¢</li>
<li>ç™¾åº¦Hiç©ºé—´</li>
<li>CSDN </li>
<li>è™šæ‹Ÿç©ºé—´ </li>
<li>åŸŸå+è™šæ‹Ÿç©ºé—´ </li>
<li>åŸŸå+VPS </li>
<li>GitHub Pages+Hexoã€‚</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/05/31/cä¸­newdeleteé‡è½½æ€»ç»“/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/05/31/cä¸­newdeleteé‡è½½æ€»ç»“/" itemprop="url">c++ä¸­new/deleteé‡è½½æ€»ç»“</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2015-05-31T22:18:55+08:00">
                2015-05-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>è¿™ä¸ªé—®é¢˜çœ‹äº†å¾ˆå¤šæ¬¡ï¼Œå¿˜äº†å¾ˆå¤šæ¬¡ï¼Œæœ€è¿‘åœ¨é‡æ¸©å†…å­˜æ± æ—¶åˆçœ‹äº†ä¸‹ï¼Œåšä¸ªç¬”è®°å§ã€‚</p>
<p>é¦–å…ˆæ˜¯ä¸¤ä¸ªåè¯ï¼šnewè¡¨è¾¾å¼ï¼Œnewæ“ä½œç¬¦ï¼Œ</p>
<p>é»˜è®¤æƒ…å†µä¸‹å½“ä½ å†™ä¸‹å¦‚ä¸‹è¯­å¥æ—¶:</p>
<p>Foo* foo = new Foo;(è¿™é‡Œæ˜¯new-expression)ï¼Œå®é™…æ‰§è¡Œäº†ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<p>1ï¼šnewè¡¨è¾¾å¼è°ƒç”¨ä¸€ä¸ªoperator newçš„æ ‡å‡†åº“å‡½æ•°ï¼Œåˆ†é…ä¸€å—è¶³å¤Ÿå¤§ã€åŸå§‹çš„ã€æœªå‘½åçš„å†…å­˜ç©ºé—´</p>
<p>2ï¼šç¼–è¯‘å™¨è¿è¡Œç›¸åº”çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¼ å…¥åˆå§‹å€¼</p>
<p>3ï¼šå¯¹è±¡åˆ†é…ç©ºé—´å¹¶æ„é€ å®Œæˆï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆ</p>
<p>delete fooï¼Œå®é™…æ‰§è¡Œäº†ä¸¤ä¸ªç›¸åçš„æ­¥éª¤ï¼š</p>
<p>1ï¼šè°ƒç”¨è¯¥å¯¹è±¡çš„ææ„å‡½æ•°</p>
<p>2ï¼šè°ƒç”¨operator deleteæ ‡å‡†åº“å‡½æ•°ï¼Œå›æ”¶ç©ºé—´</p>
<p>c++ä¸­new/deleteæœ‰å¦‚ä¸‹çº§åˆ«ï¼š</p>
<ul>
<li>global new/delete</li>
<li><p>class specific new/delete<br>é€šè¿‡ä»£ç æ¥è¯´æ˜é—®é¢˜æ¯”è¾ƒç›´è§‚</p>
</li>
<li><p>é‡è½½å…¨å±€æ“ä½œç¬¦<br><pre class="brush:cpp">#include &lt;iostream&gt;<br>#include &lt;stdlib.h&gt;</pre></p>
</li>
</ul>
<p>class Foo<br>{<br>public:<br>    Foo()<br>    {<br>        std::cout &lt;&lt; <strong>FUNCTION</strong> &lt;&lt; std::endl;<br>    }<br>    ~Foo()<br>    {<br>        std::cout &lt;&lt; <strong>FUNCTION</strong> &lt;&lt; std::endl;<br>    }<br>};</p>
<p>//é‡è½½å…¨å±€newæ“ä½œç¬¦ï¼Œå’Œä¸€èˆ¬çš„æ“ä½œç¬¦é‡è½½ç±»ä¼¼<br>void<em> operator new(size_t sz)<br>{<br>    std::cout &lt;&lt; <strong>FUNCTION</strong> &lt;&lt; std::endl;<br>    void</em> m = malloc(sz);<br>    if(!m)<br>    {<br>        std::cerr &lt;&lt; â€œout of memoryâ€ &lt;&lt; std::endl;<br>    }</p>
<pre><code>return m;
</code></pre><p>}</p>
<p>//é‡è½½å…¨å±€deleteæ“ä½œç¬¦ï¼Œå’Œä¸€èˆ¬çš„æ“ä½œç¬¦é‡è½½ç±»ä¼¼<br>void operator delete(void* m)<br>{<br>    std::cout &lt;&lt; <strong>FUNCTION</strong> &lt;&lt; std::endl;<br>    free(m);<br>}</p>
<p>int main(int argc, const char<em> argv[])<br>{<br>    //new-expression(è¡¨è¾¾å¼)<br>    //é¦–å…ˆè°ƒç”¨å…¨å±€çš„operator(æ“ä½œç¬¦) newåˆ†é…å†…å­˜,å†è°ƒç”¨æ„é€ å‡½æ•°<br>    Foo</em> foo = new Foo;<br>    //delete-expression<br>    //é¦–å…ˆè°ƒç”¨ææ„å‡½æ•°,å†è°ƒç”¨å…¨å±€çš„operator(æ“ä½œç¬¦) deleteé‡Šæ”¾å†…å­˜<br>    delete foo;</p>
<pre><code>return 0;
</code></pre><p>}</p>
<ul>
<li>ç±»æ“ä½œç¬¦<br><pre class="brush:cpp">#include &lt;cstddef&gt;<br>#include &lt;iostream&gt;<br>#include &lt;new&gt;</pre></li>
</ul>
<p>class Framis<br>{<br>    enum { sz = 10 };<br>    char c[sz]; // To take up space, not used<br>    static unsigned char pool[];<br>    static bool alloc_map[];<br>public:<br>    enum { psize = 100 };  // frami allowed<br>    Framis() { std::cout &lt;&lt; <strong>FUNCTION</strong> &lt;&lt; std::endl; }<br>    ~Framis() { std::cout &lt;&lt; <strong>FUNCTION</strong> &lt;&lt; std::endl; }<br>    void<em> operator new(size_t) throw(std::bad_alloc);<br>    void operator delete(void</em>);<br>};</p>
<p>unsigned char Framis::pool[psize * sizeof(Framis)];<br>bool Framis::alloc_map[psize] = {false};</p>
<p>// Size is ignored â€“ assume a Framis object<br>void<em> Framis::operator new(size_t) throw(std::bad_alloc)<br>{<br>    for(int i = 0; i &lt; psize; i++)<br>    {<br>        if(!alloc_map[i])<br>        {<br>            std::cout &lt;&lt; â€œusing block â€œ &lt;&lt; i &lt;&lt; â€œ â€¦ â€œ;<br>            alloc_map[i] = true; // Mark it used<br>            return pool + (i </em> sizeof(Framis));<br>        }<br>    }<br>    std::cout &lt;&lt; â€œout of memoryâ€ &lt;&lt; std::endl;<br>    throw std::bad_alloc();<br>}</p>
<p>void Framis::operator delete(void* m)<br>{<br>    if(!m) return; // Check for null pointer<br>    // Assume it was created in the pool<br>    // Calculate which block number it is:<br>    unsigned long block = (unsigned long)m - (unsigned long)pool;<br>    block /= sizeof(Framis);<br>    std::cout &lt;&lt; â€œfreeing block â€œ &lt;&lt; block &lt;&lt; std::endl;<br>    // Mark it free:<br>    alloc_map[block] = false;<br>}</p>
<p>int main()<br>{<br>    Framis<em> f[Framis::psize];<br>    try<br>    {<br>        for(int i = 0; i &lt; Framis::psize; i++)<br>        {<br>            f[i] = new Framis;<br>        }<br>        new Framis; // std::cout of memory<br>    }<br>    catch(std::bad_alloc)<br>    {<br>        std::cerr &lt;&lt; â€œout of memory!â€ &lt;&lt; std::endl;<br>    }<br>    delete f[10];<br>    f[10] = 0;<br>    // Use released memory:<br>    Framis</em> x = new Framis;<br>    delete x;<br>    for(int j = 0; j &lt; Framis::psize; j++)<br>    {<br>        delete f[j]; // Delete f[10] OK<br>    }</p>
<pre><code>return 0;
</code></pre><p>}<br>ä¸Šé¢çš„ä¾‹å­æ˜¯ä»&lt;&lt;think in c++&gt;&gt;ä¸­copyè¿‡æ¥çš„ï¼Œç±»çš„new/deleteæ“ä½œç¬¦å‡½æ•°ï¼Œå°½ç®¡ä½ å¯ä»¥ä¸å†™staticå…³é”®å­—ï¼Œä½†æ˜¯ç¼–è¯‘å™¨å…¶å®æŠŠå…¶å½“åšstaticå‡½æ•°çš„ã€‚</p>
<p>å¦å¤–è¿˜æœ‰ä¸ªå«åšplacement new/deleteè¡¨è¾¾å¼çš„é‡è½½ï¼Œå¯ä»¥åœ¨æŒ‡å®šçš„åœ°å€ç©ºé—´ä¸Šæ„é€ /ææ„å¯¹è±¡ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/03/11/designing-distributed-systems/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/03/11/designing-distributed-systems/" itemprop="url">Designing Distributed Systems</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2014-03-11T01:01:58+08:00">
                2014-03-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/architecture/" itemprop="url" rel="index">
                    <span itemprop="name">architecture</span>
                  </a>
                </span>

                
                
                  ï¼Œ 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/architecture/è½¬è½½/" itemprop="url" rel="index">
                    <span itemprop="name">è½¬è½½</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Bill-Venners"><a href="#Bill-Venners" class="headerlink" title="Bill Venners"></a>Bill Venners</h4><blockquote>
<p>What is important to keep in mind when you are designing a distributed system?</p>
</blockquote>
<h4 id="Ken-Arnold"><a href="#Ken-Arnold" class="headerlink" title="Ken Arnold"></a>Ken Arnold</h4><blockquote>
<p>We should start off with some notion of what we mean by distributed system. A distributed system, in the sense in which I take any interest, means a system in which the failure of an unknown computer can screw you.</p>
<p><strong>Failure</strong> is not such an important factor for some multicomponent distributed systems. Those systems are tightly controlled; nobody ever adds anything unexpectedly; they are designed so that all components go up and down at the same time. You can create systems like that, but those systems are relatively uninteresting. They are also quite rare.</p>
<p>Failure is the defining difference between distributed and local programming, so you have to design distributed systems with the expectation of failure. Imagine asking people, â€œIf the probability of something happening is one in ten to the thirteenth, how often would it happen?â€ Your natural human sense would be to answer, â€œNever.â€ That is an infinitely large number in human terms. But if you ask a physicist, she would say, â€œAll the time. In a cubic foot of air, those things happen all the time.â€ When you design distributed systems, you have to say, â€œFailure happens all the time.â€ So when you design, you design for failure. It is your number one concern.</p>
<p>Yes, you have to get done what you have to get done, but you have to do it in the context of failure. One reason it is easier to write systems with Jini and RMI (remote method invocation) is because theyâ€™ve taken the notion of failure so seriously. We gave up on the idea of local/remote transparency. Itâ€™s a nice thought, but so is instantaneous faster-than-light travel. It is demonstrably true that at least so far transparency is not possible.</p>
</blockquote>
<h2 id="Partial-Failure"><a href="#Partial-Failure" class="headerlink" title="Partial Failure"></a>Partial Failure</h2><blockquote>
<p>What does designing for failure mean? One classic problem is partial failure. If I send a message to you and then a network failure occurs, there are two possible outcomes. One is that the message got to you, and then the network broke, and I just couldnâ€™t get the response. The other is the message never got to you because the network broke before it arrived. So if I never receive a response, how do I know which of those two results happened? I cannot determine that without eventually finding you. The network has to be repaired or you have to come up, because maybe what happened was not a network failure but you died.</p>
<p>Now this is not a question you ask in local programming. You invoke a method and an object. You donâ€™t ask, â€œDid it get there?â€ The question doesnâ€™t make any sense. But it is the question of distributed computing.</p>
<p>So considering the fact that I can invoke a method on you and not know if it arrives, how does that change how I design things? For one thing, it puts a multiplier on the value of simplicity. The more things I can do with you, the more things I have to think about recovering from. That also means the conceptual cost of having more functionality has a big multiplier. In my nightmares, Iâ€™ll tell you itâ€™s exponential, and not merely a multiplier. Because now I have to ask, â€œWhat is the recovery strategy for everything on which I interact with you?â€ That also implies that you want a limited number of possible recovery strategies.</p>
</blockquote>
<h2 id="Transactions"><a href="#Transactions" class="headerlink" title="Transactions"></a>Transactions</h2><blockquote>
<p>So what are those recovery strategies? J2EE (Java 2 Platform, Enterprise Edition) and many distributed systems use transactions. Transactions say, â€œI donâ€™t know if you received it, so I am forcing the system to act as if you didnâ€™t.â€ I will abort the transaction. Then if you are down, youâ€™ll come up a week from now and youâ€™ll be told, â€œForget about that. It never happened.â€ And you will.</p>
<p>Transactions are easy to understand: I donâ€™t know if things failed, so I make sure they failed and I start over again. That is a legitimate, straightforward way to deal with failure. It is not a cheap way however.</p>
<p>Transactions tend to require multiple players, usually at least one more player than the number of transaction participants, including the client. And even if you can optimize out the extra player, there are still more messages that say, â€œAm I ready to go forward? Do you want to go forward? Do you think we should go forward? Yes? Then I think itâ€™s time to go forward.â€ All of those messages have to happen.</p>
<p>And even with a two-phase commit, there are some small windows that can leave you in ambiguous states. A human being eventually has to interrupt and say, â€œYou know, that thing did go away and itâ€™s never coming back. So donâ€™t wait.â€ Say you have three participants in a transaction. Two of them agree to go forward and are waiting to be told to go. But the third one crashes at an inopportune time before it has a chance to vote, so the first two are stuck. There is a small window there. I think it has been proven that it doesnâ€™t matter how many phases you add, you canâ€™t make that window go away. You can only narrow it slightly.</p>
<p>So the transactions approach isnâ€™t perfect, although those kinds of problems happen rarely enough. Maybe instead of ten to the thirteenth, the probability is ten to the thirtieth. Maybe you can ignore it, I donâ€™t know. But that window is certainly a worry.</p>
<p>The main point about transactions is that it has overhead. You have to create the transaction and you have to abort it. One of the things that a container like J2EE does for you is that it hides a lot of that from you. Most things just know that thereâ€™s a transaction around them. If somebody thinks it should be aborted, it will be aborted. But most things donâ€™t have to participate very directly in aborting the transaction. That makes it simpler.</p>
</blockquote>
<h2 id="Idempotency"><a href="#Idempotency" class="headerlink" title="Idempotency"></a>Idempotency</h2><blockquote>
<p>I tend to prefer something called idempotency. You canâ€™t solve all problems with it, but basically idempotency says that reinvoking the method will be harmless. It will give you an equivalent result as having invoked it once.</p>
<p>If I want to manipulate a bank account, I send in an operation ID: â€œThis is operation number 75. Please deduct $100 from this bank account.â€ If I get a failure, I just keep sending it until it gets through. If youâ€™re the recipient, you say, â€œOh, 75. Iâ€™ve seen that one, so Iâ€™ll ignore it.â€ It is a simple way to deal with partial failure. Basically, recovery is simple retry. Or, potentially, you give up by sending a cancel operation for the ID until that gets through. If you want to do that, though, youâ€™re more likely to use transactions so you can abort them.</p>
<p>Generally, with idempotency, everybody needs to know how to go forward. But people donâ€™t often need to know how to go back. I donâ€™t abort a transaction. I just repeatedly try again until I succeed. That means I need to know how to say to do this. I donâ€™t have to deal with all sorts of ugly recovery most of the time.</p>
<p>Now, what happens if failure increases on the network? You start sending messages more often. If that is a problem, for a long distance you can solve it by writing a check and buying more hardware. Hardware is much cheaper than programmers. Other ways of dealing with this tend to increase the systemâ€™s complexity, requiring more programmers.</p>
</blockquote>
<h2 id="Bill-Venners-1"><a href="#Bill-Venners-1" class="headerlink" title="Bill Venners"></a>Bill Venners</h2><blockquote>
<p>Do you mean transactions?</p>
</blockquote>
<h2 id="Ken-Arnold-1"><a href="#Ken-Arnold-1" class="headerlink" title="Ken Arnold"></a>Ken Arnold</h2><blockquote>
<p>Transactions on everything can increase complexity. Iâ€™m just talking about transactions and idempotency now, but other recovery mechanisms exist.</p>
<p>If I just have to try everything twice, if I can simply reject the second request if something has already been done, I can just buy another computer and a better networkâ€”up to some limit, obviously. At some point, thatâ€™s no longer true. But a bigger computer is more reliable and cheaper than another programmer. I tend to like simple solutions and scaling problems that can be solved with checkbooks, even though I am a programmer myself.</p>
</blockquote>
<h2 id="Wide-Area-Distributed-Systems"><a href="#Wide-Area-Distributed-Systems" class="headerlink" title="Wide-Area Distributed Systems"></a>Wide-Area Distributed Systems</h2><h4 id="Bill-Venners-2"><a href="#Bill-Venners-2" class="headerlink" title="Bill Venners"></a>Bill Venners</h4><blockquote>
<p>Is there anything in particular about Internet- wide distributed systems or large wide area networks that is different from smaller ones? Dealing with increased latency, for example?</p>
</blockquote>
<h4 id="Ken-Arnold-2"><a href="#Ken-Arnold-2" class="headerlink" title="Ken Arnold"></a>Ken Arnold</h4><blockquote>
<p>Yes, latency has a lot to do with it. When you design anything, local or remote, efficiency one of the things you think about. Latency is an important issue. Do you make many little calls or one big call? One of the great things about Jini is that, if you can use objects, you can present an API whose natural model underneath deals with latency by batching up requests where it can. It adapts to the latency that it is in. So you can get away from some of it, but latency is a big issue.</p>
<p>Another issue is of course security. Inside a corporate firewall you say, â€œWeâ€™ll do something straightforward, and if somebody is mucking around with it, weâ€™ll take them to court.â€ But that is clearly not possible on the Internet; it is a more hostile environment. So you either have to make things not care, which is fine when you donâ€™t care if somebody corrupts your data. Or, you better make it so they canâ€™t corrupt your data. So aside from latency, security is the other piece to think about in widely distributed systems.</p>
</blockquote>
<h2 id="State-is-Hell"><a href="#State-is-Hell" class="headerlink" title="State is Hell"></a>State is Hell</h2><h4 id="Bill-Venners-3"><a href="#Bill-Venners-3" class="headerlink" title="Bill Venners"></a>Bill Venners</h4><blockquote>
<p>What about state?</p>
</blockquote>
<h4 id="Ken-Arnold-3"><a href="#Ken-Arnold-3" class="headerlink" title="Ken Arnold"></a>Ken Arnold</h4><blockquote>
<p>State is hell. You need to design systems under the assumption that state is hell. Everything that can be stateless should be stateless.</p>
</blockquote>
<h4 id="Bill-Venners-4"><a href="#Bill-Venners-4" class="headerlink" title="Bill Venners"></a>Bill Venners</h4><blockquote>
<p>Define what you mean by that.</p>
</blockquote>
<h4 id="Ken-Arnold-4"><a href="#Ken-Arnold-4" class="headerlink" title="Ken Arnold"></a>Ken Arnold</h4><blockquote>
<p>In this sense, state is essentially something held in one place on behalf of somebody who is in another place, something that is not reconstructible by the other entity that wants it. If I can reconstruct it, itâ€™s called a cache. And caches are often OK. Caching strategies are their own branch of computer science, and you can screw them up. But as a general rule, I send you a bunch of information and you send me the shorthand for it. I start to interact with you using this shorthand. I pass the integer back to you to refer to the cached data: â€œIâ€™m talking about interaction number 17.â€ And then you go down. I can send that same state to some equivalent service to you, and build myself back up. That kind of state is essentially a cache.</p>
<p>Caching can get complex. Itâ€™s the question that Jini solves with leasing. If one of us goes down, when can the person holding the cache throw this stuff away? Leasing is a good answer to that. There are other answers, but leasing is a pretty elegant one.</p>
<p>On the other hand, if you store information that I canâ€™t reconstruct, then a whole host of questions suddenly surface. One question is, â€œAre you now a single point of failure?â€ I have to talk to you now. I canâ€™t talk to anyone else. So what happens if you go down?</p>
<p>To deal with that, you could be replicated. But now you have to worry about replication strategies. What if I talk to one replicant and modify some data, then I talk to another? Is that modification guaranteed to have already arrived there? What is the replication strategy? What kind of consistency do you needâ€”tight or loose? What happens if the network gets partitioned and the replicants canâ€™t talk to each other? Can anybody proceed?</p>
<p>There are answers to these questions. A whole branch of computer science is devoted to replication. But it is a nontrivial issue. You can almost always get into some state where you canâ€™t proceed. You no longer have a single point of failure. You have reduced the probability of not being able to proceed, but you havenâ€™t eliminated it.</p>
<p>If my interaction with you is stateless in the sense Iâ€™ve describedâ€”nothing more than a cacheâ€”then your failure can only slow me down if thereâ€™s an equivalent service to you. And that equivalent service can come up after you go down. It doesnâ€™t necessarily have to be there in advance for failover.</p>
<p>So, generally, state introduces a whole host of problems and complications. People have solved them, but they are hell. So I follow the rule: make everything you can stateless. If there is one piece of the system you canâ€™t make statelessâ€”it has to have stateâ€”to the extent possible make it hold all the state. Have as few stateful components as you can.</p>
<p>If you end up with a system of five components and two of them have state, ask yourself if only one can have state. Because, assuming all components are critical, if either of the two stateful components goes down you are screwed. So you might as well have just one stateful component. Then at least four, instead of three, components have this wonderful feature of robustability. There are limits to how hard you should try to do that. You probably donâ€™t want to put two completely unrelated things together just for that reason. You may want to implement them in the same place. But in terms of defining the interfaces and designing the systems, you should avoid state and then make as many components as possible stateless. The best answer is to make all components stateless. It is not always achievable, but itâ€™s always my goal.</p>
</blockquote>
<h4 id="Bill-Venners-5"><a href="#Bill-Venners-5" class="headerlink" title="Bill Venners"></a>Bill Venners</h4><blockquote>
<p>All these databases lying around are state. On the Web, every Website has a database behind it.</p>
</blockquote>
<h4 id="Ken-Arnold-5"><a href="#Ken-Arnold-5" class="headerlink" title="Ken Arnold"></a>Ken Arnold</h4><blockquote>
<p>Sure, the file system underneath a Website, even if itâ€™s just HTML, is a database. And that is one case where state is necessary. How am I going to place an order with you if I donâ€™t trust you to hold onto it? So in that case, you have to live with state hell. But a lot of work goes into that dealing with that state. If you look at the reliable, high-performance sites, that is a very nontrivial problem to solve. It is probably the distributed state problem that people are most familiar with. Anyone who has dealt with any large scale, high availability, or high performance piece of the problem knows that state is hell because theyâ€™ve lived with that hell. So the question is, â€œWhy have more hell than you need to have?â€ You have to try and avoid it. <strong><em>Avoid. Avoid. Avoid.</em></strong></p>
</blockquote>
<p>åŸæ–‡åœ°å€ï¼š<br><a href="http://www.artima.com/intv/distrib.html" title="design distributed system" target="_blank" rel="noopener">http://www.artima.com/intv/distrib.html</a>.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/02/23/liunxç³»ç»Ÿç›‘æ§-vmstat/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="billowqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="taocoding">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/02/23/liunxç³»ç»Ÿç›‘æ§-vmstat/" itemprop="url">liunxç³»ç»Ÿç›‘æ§-vmstat</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2014-02-23T22:40:55+08:00">
                2014-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
                  ï¼Œ 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/å·¥å…·/" itemprop="url" rel="index">
                    <span itemprop="name">å·¥å…·</span>
                  </a>
                </span>

                
                
                  ï¼Œ 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/å·¥å…·/è½¬è½½/" itemprop="url" rel="index">
                    <span itemprop="name">è½¬è½½</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>vmstatæ˜¯ä¸€ä¸ªå¾ˆå…¨é¢çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°ç³»ç»Ÿçš„è¿›ç¨‹ çŠ¶æ€ã€å†…å­˜ä½¿ç”¨ã€è™šæ‹Ÿå†…å­˜ä½¿ç”¨ã€ç£ç›˜çš„ IOã€ä¸­æ–­ã€ä¸Šä¸‹é—®åˆ‡ æ¢ã€CPUä½¿ç”¨ç­‰ã€‚ç³»ç»Ÿæ€§èƒ½åˆ†æå·¥å…·ä¸­ï¼Œæˆ‘ä½¿ç”¨æœ€å¤šçš„æ˜¯è¿™ä¸ªï¼Œé™¤äº† sysstat å·¥å…·åŒ…å¤–ï¼Œè¿™ä¸ªå·¥å…·èƒ½æŸ¥çœ‹çš„ç³»ç»Ÿèµ„æºæœ€å¤šã€‚å¯¹äº Linux çš„æ€§èƒ½åˆ†æï¼Œ100%ç†è§£ vmstat è¾“å‡ºå†…å®¹çš„å«ä¹‰ï¼Œ é‚£ä½ å¯¹ç³»ç»Ÿæ€§èƒ½åˆ†æçš„èƒ½åŠ›å°±ç®—æ˜¯åŸºæœ¬æŒæ¡äº†ã€‚æˆ‘è¿™é‡Œä¸»è¦è¯´æ˜ä¸€ä¸‹è¿™ä¸ªå‘½ä»¤æ˜¾ç¤ºå‡ºçš„éƒ¨åˆ†æ•°æ®ä»£è¡¨çš„å«ä¹‰ï¼Œå’Œ å®ƒåæ˜ å‡ºç³»ç»Ÿç›¸å…³èµ„æºçš„çŠ¶å†µã€‚è¾“å‡ºå†…å®¹å…±æœ‰ 6 ç±»ï¼Œåˆ†åˆ«è¯´æ˜å¦‚ä¸‹ã€‚</p>
<h3 id="å…¸å‹vmstatè¾“å‡º"><a href="#å…¸å‹vmstatè¾“å‡º" class="headerlink" title="å…¸å‹vmstatè¾“å‡º"></a>å…¸å‹vmstatè¾“å‡º</h3><p><img src="/images/2014/02/vmstat-output.png" alt="" title="vmstatè¾“å‡º"></p>
<h3 id="procs"><a href="#procs" class="headerlink" title="procs"></a>procs</h3><ul>
<li><p>rè¿è¡Œçš„å’Œç­‰å¾…(CPUæ—¶é—´ç‰‡)è¿è¡Œçš„è¿›ç¨‹æ•°ï¼Œ è¿™ä¸ªå€¼ä¹Ÿå¯ä»¥åˆ¤æ–­æ˜¯å¦éœ€è¦å¢åŠ CPU(é•¿æœŸå¤§äº1)</p>
</li>
<li><p>bå¤„äºä¸å¯ä¸­æ–­çŠ¶æ€çš„è¿›ç¨‹æ•°ï¼Œå¸¸è§çš„æƒ…å†µ æ˜¯ç”±IOå¼•èµ·çš„</p>
</li>
</ul>
<h3 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h3><ul>
<li>swpd: åˆ‡æ¢åˆ°äº¤æ¢å†…å­˜ä¸Šçš„å†…å­˜(é»˜è®¤ä»¥KBä¸ºå•ä½) å¦‚æœ swpd çš„å€¼ä¸ä¸º0ï¼Œæˆ–è€…è¿˜æ¯”è¾ƒå¤§ï¼Œæ¯”å¦‚è¶…è¿‡100Mäº†ï¼Œä½†æ˜¯ si, so çš„å€¼é•¿æœŸä¸º 0ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥ä¸ç”¨æ‹…å¿ƒï¼Œä¸ä¼šå½±å“ç³»ç»Ÿæ€§èƒ½ã€‚</li>
<li>free: ç©ºé—²çš„ç‰©ç†å†…å­˜</li>
<li>buff: ä½œä¸ºbuffer cacheçš„å†…å­˜ï¼Œå¯¹å—è®¾å¤‡çš„è¯»å†™è¿›è¡Œç¼“å†²</li>
<li>cache: ä½œä¸ºpage cacheçš„å†…å­˜, æ–‡ä»¶ç³»ç»Ÿçš„cache å¦‚æœ cache çš„å€¼å¤§çš„æ—¶å€™ï¼Œè¯´æ˜cacheä½çš„æ–‡ä»¶æ•°å¤šï¼Œå¦‚æœé¢‘ ç¹è®¿é—®åˆ°çš„æ–‡ä»¶éƒ½èƒ½è¢«cacheä½ï¼Œé‚£ä¹ˆç£ç›˜çš„è¯»IO-biä¼šéå¸¸å°ã€‚</li>
</ul>
<h3 id="Swap"><a href="#Swap" class="headerlink" title="Swap"></a>Swap</h3><ul>
<li>si: äº¤æ¢å†…å­˜ä½¿ç”¨ï¼Œç”±ç£ç›˜è°ƒå…¥å†…å­˜</li>
<li>so: äº¤æ¢å†…å­˜ä½¿ç”¨ï¼Œç”±å†…å­˜è°ƒå…¥ç£ç›˜</li>
</ul>
<p>å†…å­˜å¤Ÿç”¨çš„æ—¶å€™ï¼Œè¿™2ä¸ªå€¼éƒ½æ˜¯0ï¼Œå¦‚æœè¿™2ä¸ªå€¼é•¿æœŸ å¤§äº0æ—¶ï¼Œç³»ç»Ÿæ€§èƒ½ä¼šå—åˆ°å½±å“ã€‚ç£ç›˜IOå’ŒCPUèµ„ æºéƒ½ä¼šè¢«æ¶ˆè€—ã€‚æˆ‘å‘ç°æœ‰äº›æœ‹å‹çœ‹åˆ°ç©ºé—²å†…å­˜(free)å¾ˆå°‘æˆ–æ¥è¿‘äº0 æ—¶ï¼Œå°±è®¤ä¸ºå†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œå®é™…ä¸Šä¸èƒ½å…‰çœ‹è¿™ä¸€ç‚¹ çš„ï¼Œè¿˜è¦ç»“åˆsi,soï¼Œ å¦‚æœfreeå¾ˆå°‘ï¼Œä½†æ˜¯si,soä¹Ÿå¾ˆ å°‘(å¤§å¤šæ—¶å€™æ˜¯0)ï¼Œé‚£ä¹ˆä¸ç”¨æ‹…å¿ƒï¼Œç³»ç»Ÿæ€§èƒ½è¿™æ—¶ ä¸ä¼šå—åˆ°å½±å“çš„ã€‚</p>
<h3 id="Io"><a href="#Io" class="headerlink" title="Io"></a>Io</h3><ul>
<li>bi: ä»å—è®¾å¤‡è¯»å…¥çš„æ•°æ®æ€»é‡(è¯»ç£ç›˜) (KB/s)ï¼Œ</li>
<li>bo: å†™å…¥åˆ°å—è®¾å¤‡çš„æ•°æ®æ€»ç†(å†™ç£ç›˜)(KB/s)</li>
</ul>
<p>éšæœºç£ç›˜è¯»å†™çš„æ—¶å€™ï¼Œè¿™2ä¸ªå€¼è¶Šå¤§ï¼ˆå¦‚è¶…å‡º1Mï¼‰ï¼Œèƒ½çœ‹åˆ°CPUåœ¨IOç­‰å¾…çš„å€¼ä¹Ÿä¼šè¶Šå¤§</p>
<h3 id="System"><a href="#System" class="headerlink" title="System"></a>System</h3><ul>
<li>in: æ¯ç§’äº§ç”Ÿçš„ä¸­æ–­æ¬¡æ•°</li>
<li>cs: æ¯ç§’äº§ç”Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•° ä¸Šé¢è¿™2ä¸ªå€¼è¶Šå¤§ï¼Œä¼šçœ‹åˆ°ç”±å†…æ ¸æ¶ˆè€—çš„CPUæ—¶é—´ä¼šè¶Šå¤š</li>
</ul>
<h3 id="Cpu"><a href="#Cpu" class="headerlink" title="Cpu"></a>Cpu</h3><ul>
<li>us: ç”¨æˆ·è¿›ç¨‹æ¶ˆè€—çš„CPUæ—¶é—´ç™¾åˆ†æ¯” usçš„å€¼æ¯”è¾ƒé«˜æ—¶ï¼Œè¯´æ˜ç”¨æˆ·è¿›ç¨‹æ¶ˆè€—çš„CPUæ—¶é—´å¤šï¼Œä½†æ˜¯å¦‚æœ é•¿æœŸè¶…è¿‡50% çš„ä½¿ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯¥è€ƒè™‘ä¼˜åŒ–ç¨‹åºç®—æ³•æˆ–è€…è¿› è¡ŒåŠ é€Ÿäº†(æ¯”å¦‚ PHP/Perl)</li>
<li>sy: å†…æ ¸è¿›ç¨‹æ¶ˆè€—çš„CPUæ—¶é—´ç™¾åˆ†æ¯” sy çš„å€¼é«˜æ—¶ï¼Œè¯´æ˜ç³»ç»Ÿå†…æ ¸æ¶ˆè€—çš„CPUèµ„æºå¤šï¼Œè¿™å¹¶ä¸æ˜¯è‰¯æ€§ çš„è¡¨ç°ï¼Œæˆ‘ä»¬åº”è¯¥æ£€æŸ¥åŸå› ã€‚</li>
<li>wa: IOç­‰å¾…æ¶ˆè€—çš„CPUæ—¶é—´ç™¾åˆ†æ¯” wa çš„å€¼é«˜æ—¶ï¼Œè¯´æ˜IOç­‰å¾…æ¯”è¾ƒä¸¥é‡ï¼Œè¿™å¯èƒ½æ˜¯ç”±äºç£ç›˜å¤§é‡ä½œ éšæœºè®¿é—®é€ æˆï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ç£ç›˜çš„å¸¦å®½å‡ºç°ç“¶é¢ˆ(å—æ“ä½œ)ã€‚</li>
<li>id: CPUå¤„åœ¨ç©ºé—²çŠ¶æ€æ—¶é—´ç™¾åˆ†æ¯”</li>
</ul>
<h3 id="æƒ…æ™¯åˆ†æ"><a href="#æƒ…æ™¯åˆ†æ" class="headerlink" title="æƒ…æ™¯åˆ†æ"></a>æƒ…æ™¯åˆ†æ</h3><p>è¿™ä¸ªvmstatçš„è¾“å‡ºé‚£äº›ä¿¡æ¯å€¼å¾—å…³æ³¨</p>
<ul>
<li>Procs r: è¿è¡Œçš„è¿›ç¨‹æ¯”è¾ƒå¤šï¼Œç³»ç»Ÿå¾ˆç¹å¿™</li>
<li>Io bo: ç£ç›˜å†™çš„æ•°æ®é‡ç¨å¤§ï¼Œå¦‚æœæ˜¯å¤§æ–‡ä»¶çš„å†™ï¼Œ10Mä»¥å†…åŸºæœ¬ä¸ç”¨æ‹…å¿ƒï¼Œå¦‚æœæ˜¯å°æ–‡ä»¶å†™2Mä»¥å†…åŸºæœ¬æ­£å¸¸</li>
<li>Cpu us: æŒç»­å¤§äº50ï¼ŒæœåŠ¡é«˜å³°æœŸå¯ä»¥æ¥å—</li>
<li>Cpu wa: ç¨å¾®æœ‰äº›é«˜</li>
<li>Cpu id:æŒç»­å°äº50ï¼ŒæœåŠ¡é«˜å³°æœŸå¯ä»¥æ¥å—</li>
</ul>
<p>è½¬è½½å¹¶æ•´ç†è‡ªï¼š<a href="http://fafeng.blogbus.com/logs/6541705.html" target="_blank" rel="noopener">http://fafeng.blogbus.com/logs/6541705.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">billowqiu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">153</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">30</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/billowqiu" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:billowqiu@163.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">billowqiu</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
